#!/bin/sh

set -e

# kotlin-stdlib.jar kotlin-compiler.jar kotlin-daemon-client.jar kotlin-daemon.jar
if [ -z "$KOTLIN_LIB" ]; then
    echo "environment variable '$KOTLIN_LIB' is missing" 
    exit 1
fi

mkdir -p out/nob

if [ ! -f out/nob/NobKt.class ]; then
    echo "[INFO] bootstrapping nob.kt"
    kotlinc nob.kt -cp "$KOTLIN_LIB/*" -d out
fi

java -cp "out:$KOTLIN_LIB/*" nob.NobKt $@
# java -XX:StartFlightRecording=duration=60s,filename=rec.jfr -cp "out:$LIBS" nob.NobKt $@

